%YAML 1.1
---
$schema: "http://stsci.edu/schemas/yaml-schema/draft-01"
id: "http://stsci.edu/schemas/asdf/0.1.0/wcs/wcs"
tag: "tag:stsci.edu:asdf/0.1.0/wcs/wcs"
title: >
  A system for describing generalized world coordinate transformations.
description: >
  ASDF WCS is a way of specifying transformations (usually from
  detector space to world coordinate space and back) by using the
  transformations in the `transform-schema` module.
examples:
  -
    - A complex example where...
    - |
      !wcs/wcs
        steps: !wcs/steps
          - !wcs/step
            # Name is the name for the step.  This will allow for an
            # API to say "transform from pixel to focal_plane".  These
            # names are completely arbitrary and do not come from a
            # controlled vocabulary.
            name: pixel

            # axes is a list describing the coordinate frame and other
            # information for each axis.
            axes:
              - !wcs/axis
                type: detector
                name: y
                unit: !unit/unit pixel
              - !wcs/axis
                type: detector
                name: x
                unit: !unit/unit pixel
              - !wcs/axis
                type: detector
                name: lambda
                unit: !unit/unit nm
              - !wcs/axis
                type: custom
                name: order

            transform: !transform/concatenate
              forward:
                - !transform/generic
                  n_inputs: 4
                  n_outputs: 4
                - !transform/join
                  forward:
                  - !transform/generic
                    n_inputs: 3
                    n_outputs: 3
                  - !transform/identity
                    n_dims: 1

          - !wcs/step
            # At this step, the wavelength is now independent of the spatial
            # dimensions.  So we proceed with separate transformations
            # for the two separable parts from here on out.
            name: intermediate

            axes:
              - !wcs/axis
                type: focal_plane
                name: x
              - !wcs/axis
                type: focal_plane
                name: y
              - !wcs/axis
                type: spectral
                name: lambda
              - !wcs/axis
                type: custom
                name: order

            transform: !transform/join  # in 4 --> out 3
              forward:
              - !transform/rotate2d
                angle: 0.3
              # spectral_with_order takes (order, lambda) as inputs, so
              # we swap them first
              - !transform/concatenate  # in 2 --> out 1
                forward:
                - !transform/generic
                  n_inputs: 2
                  n_outputs: 2
                - !transform/generic
                  n_inputs: 2
                  n_outputs: 1

          - !wcs/step
            # The last step has no transform, but is used to
            # specify the frames and units of the resulting axes.
            name: world

            axes:
              - !wcs/axis
                type: celestial
                celestial_type: ICRS
                name: ra
                unit: !unit/unit degree
              - !wcs/axis
                type: celestial
                celestial_type: ICRS
                name: dec
                unit: !unit/unit degree
              - !wcs/axis
                type: spectral
                name: lambda
                unit: !unit/unit Hz

type: object
properties:
  steps:
    description: |
      A list of steps in the forward transformation from detector to
      world coordinates.

      The inverse transformation is determined automatically by
      reversing this list, and inverting each of the individual
      transforms according to the rules described in :ref:`inverse
      <http://stsci.edu/schemas/asdf/0.1.0/transform/transform/anyOf/0/properties/inverse>`.

    $ref: steps

required: [steps]
additionalProperties: false
